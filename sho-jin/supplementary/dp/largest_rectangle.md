# 最大長方形関連

AOJでいうと[ここの3問](https://onlinejudge.u-aizu.ac.jp/courses/library/7/DPL/3)
を解くために必要な知識。

## ヒストグラム中の最大長方形

解説: http://algorithms.blog55.fc2.com/blog-entry-132.html

愚直にやると `O(N^2), Nはヒストグラムの横軸の長さ` だが、
特殊な動的計画法によって `O(N)` で解ける。

ポイントは以下。

- スタックに「長方形の情報」をもたせる。
- 「長方形の情報」とは、具体的には以下の2つ。
  - 「長方形の高さ」と「その長方形の左端の位置」

アルゴリズムの流れとしては、ポイントは以下。

- ヒストグラムの左端から順にスキャンして調べていく。
- 現在注目している柱が、スタックトップの長方形と比較して、、
  - 高い場合は、新しくスタックに長方形を積む（新しい高い長方形が積まれるイメージ）
  - 同じ場合は、何もしない（直前の長方形が継続するイメージ）
  - 低い場合は、スタックからポップしながら、それまでの長方形の面積を計算し、必要なら更新する
    - 最後に現在の柱を新しい長方形として追加するが、そのときの左端は「最後にポップした長方形」のものを流用する

## グリッド中の最大正方形

解説: http://algorithms.blog55.fc2.com/blog-entry-131.html

先程のヒストグラムのスタックを使うような特殊なDPは不要で、かなり納得しやすい。

`W[i][j] := (i, j)のマスから左上にとれる、最大正方形の長さ` とする。
遷移は、左・左上・上の3方向からもらってやればよく、状態数が `h * w`、遷移が定数オーダーなので、
全体の計算量は `O(h * w)` となる。

## グリッド中の最大長方形

解説: http://algorithms.blog55.fc2.com/blog-entry-133.html

本当ならば、最大正方形の動的計画法を応用した高度なアルゴリズムになるらしいが、
実は「ヒストグラム中の最大長方形」を流用することで、シンプルかつより高速化できる（らしい）。

具体的な手順も単純で、「各マスから上に、自身を含めて何マス進めるか？」という情報を計算して、
その各行についてヒストグラム中の最大長方形を計算するだけで良い。
それらの最大値が面積そのままとなる。

