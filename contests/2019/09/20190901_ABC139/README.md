# ABC139 感想

18分で4完だが、Dが異常に簡単だったためパフォは1800ぐらい。

Eは難易度的には無理なものというわけではなかったっぽいが、
自分は再挑戦しても溶けなさそうだったので、ちゃんと時間をとってじっくりと復習する。

- A問題はfor, ifで簡単に。
- B問題は正直苦手なやつ。
  - 条件式は立てたが、切り上げ、切り捨ての部分で混乱したため、変なコードを書いてしまった。
  - PDF回答のシミュレーションする方法は賢い。
    - こういうのがぱっと出てこなくなってしまったのは精進不足のせいと思われる。。
- C問題は慎重に `O(N)` 解法をシミュレーションする。
- D問題は割とスピーディに考えられたが、検証に手間取ったのが良くない。
  - 「ありうる最大値を考える」というのは典型思考だと思っているが、冷静にこれができたのは良かった。
  - Nは最大 `10^9` だが、なんとGoでも通ってしまった。。
    - 正解は等差数列の輪を使うこと。
- E問題はなんとなくグラフを考えたりしそうというのは最後の方に考えたがわからず。
  - 愚直に求める方法ベースの手法もあるっぽいが、そもそも愚直実装もよくわかっていないので、両方の手法をしっかりと理解したい。
  - **典型チック: グラフにしたときの「閉路」は矛盾を意味することが多い（？）**
    - なんと言語化するのが正しいのか。。？

---

## E問題

### queueを使った解法

愚直なシミュレーションを、見る必要のあるところだけを見るという形で高速化したもの。

愚直にやろうとすると、毎日すべての人を舐めて、試合ができる人を探して試合をさせる、というのを日数分繰り返すことになる。
しかし、最悪ケースでは日数が `O(n^2)` になってしまうため、全体で `O(n^3)` となってしまい間に合わない。

このシミュレーションを、queueを使って高速化する。

手法の概略・ポイントは以下のような感じ。

1. 入力 `A` は各人の試合予定だと思って、先頭で次の対戦相手を参照したり、先頭の除去により試合の消化をシミュレートする。
2. 初期化として、すべての人を1周して、それぞれについて1日目の試合を組む。
3. 組んだ1日で行われる試合（予定）はqueueへと詰められ、それらを消化していく。
4. 試合が消化されたら予定表 `A` の先頭からも除去する（次の対戦相手が先頭で見えるようにする）。
5. 完全にqueueが空になったら、もう組める試合はないので判定を行う。
6. まだ対戦すべき相手が残っている選手が1人でもいたら、矛盾があるため `-1` 、そうでないなら計算していた日数を出力する。

聞くとなるほどとなるが、自力でこのシミュレーションを正確に組むのはかなり大変、という印象。
（そもそも愚直解をコードにできるだけでもすごいと思う。）

**典型: 変化の生じた部分にだけ着目する。**

### グラフに帰着する解法

試合をノードと見ると、それぞれのノードに依存関係が生まれて、整理するとDAGになる。

DAGにならない場合は矛盾となるが、DAGになる場合は「最長経路」の長さが答えとなる。

これに関しては極めて典型度合いが高いため、別個に学習して、コードは自力で書いてみることにする。

実際に自己流でDAG作成、トポロジカルソート、最長経路ソルバの部分を書いてみたが、
DP部分はそれほど難しくはなかった。
とはいえ、変な癖はつけたくないので、「DAGの最長経路問題」などで検索して調べて学習し直しておく。

DAG上のDPを初めて考えた感想・感触としては、
「**トポロジカルソート順にノードに着目することは、すでに着目ノードについては答えが求まっているという前提がある**」というのが大事だと思った。（なぜなら、前の依存関係をすでに解決済みノードから順に見ていくことになるから。）

すぬけさんの解説放送では、色々と「逆向き」で考えていた（`dp[i]: iからの最長経路の長さ`）。
トポロジカルソートと最長経路の計算を同時にやっている感じで、ちょっとむずかしいと思った。
（現状、困ってはおらずあまり学習意欲が出ないため、必要になりそうだったら考えてみる。）

### 類題

[AOJの問題](http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=2176)が類題らしい。

idsigmaさんより。

