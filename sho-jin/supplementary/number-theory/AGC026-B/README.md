# AGC026 B. rng_10s

Last Change: 2020-10-01 00:20:57.

以前解答を読んでもわからなかったので再挑戦してみた。
なんとかACは出来たものの、number theoryに慣れるために、他の開設もできる限り理解しておきたい。

## 自分の考え

必要条件を省く部分はスキップ。

> `(a%b) + n*(d%b)` の `mod b` が、いつか `c` を超えることはあるか？

という問題に帰着させることは出来た。

ここで、 `d%b` が `1, b-1` のようなときは、なんとなくダメそうだとわかる。
なぜなら、特に `d%b == 1` のときはわかりやすいが、求めたい値が `b` のあまりすべてを取りうると言えるから。

ではそれ以外のケースはどうなるか？ということを考えると、これは具体的なケースで実験してみて予想をした。

例えば、 `b=8` として `d%b == 2 or 4 or 6` あたりを実際に紙の上で実験してみる。
すると、すぐに元の位置に戻ってくることがわかる。
また、 `d%b == 6` あたりで、このジャンプ幅は `gcd(b, d)` であると予想がつく。

これを信じて（？）、 `g = gcd(b, d), (a%b) = r` とすると、もとの式は `r + n*g` となる。
これが `c` を超えるかを判定するには、 `mod b` の世界での最大値を考えればよく、
これは不等式 `r + n*g < b` を解くことで `n < Ceil((b-r)/g)` より、
`n = Ceil((b-r)/g) - 1` のときであると言える。
この `n` のもとで式の値が `c` を超えるかどうかを判定すれば良い。

## けんちょん氏の解説

[ここ。](https://drken1215.hatenablog.com/entry/2018/07/18/083000)

公式や他の人の解説を含めて、一番わかりやすかった。
また、自分の考えに一番近いと思った。

`mod b` の世界で考えるのではなく、ジュースの本数としてありうるものを一般的に式にしている。

すなわち `d*p - b*q + a` と表される（仕入れが `q` 回、購入が `q` 回という状況）。

この式の `d*p - b*q` の部分はベズー等式（一次不定方程式、拡張ユークリッドの互除法）から、
`gcd(b, d)` の倍数であるといえる。
よって式は `a + n*gcd(b, d)` と表され、これが `[c+1, b-1]` の間に入るような値はあるか？
という判定問題になる。

`b` 未満で最大の数は `b - g + (a%g)` であるというのは（意外と）かんたんにわかる。
これは、 `g` で割って `a%g` あまる数を考えると、 `g` の倍数で `b` 未満の最大を考えると `b-g` であり、
これに `g` 未満の `a%g` を加算したもので、これが明らかに最大となる。

## けんちょん氏の解説を読んでから自分の解答を見直す

自分は最初から `mod b` の世界で考えていたが、よくよく考えると `n*d mod b` という値は、
`mod b` の世界から抜け出すと `n*d + m*b` であるといえる。
ここでベズー等式を考えると、これも `gcd(b, d)` の倍数をとると考えられ、
つまりは `b` のあまりを `gcd(b, d)` 飛びで動き回ることがわかる。

