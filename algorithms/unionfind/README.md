# Union-Find（蘇州号データ構造）

https://www.slideshare.net/chokudai/union-find-49066733/1

グループ分けを管理し、**「まとめる」と「判定」の2つのクエリに対応する。**

**経路圧縮**: 根を調べる際に、親を直接グループの根に張り替える。
**ランク**: 木の高さを保持し、低い方を高い方につなげる。

## 計算量

経路圧縮のみでおおよそ `O(log(n))` 。

## 注意点

Union-Find木はグループを併合することはできても **分割することはできない。**

## インターフェース

「まとめる」と「判定」が外部から受け付ける操作であるため、
`Unite` と `Same` が公開される関数。

。。と思っていたが、ABC049のD問題などでは、別々のネットワーク間でのUnionFind木の親ノードについて調べなければならず、
`Root` 関数についても使用する必要があった。

## 連結成分のサイズを管理できるUnionFindアルゴリズム

詳しくは[ABC040のD問題](https://atcoder.jp/contests/abc040/tasks/abc040_d)を参照すること。

1. 初期化時に、すべてのノードについてサイズを1としてサイズ配列を初期化しておく。
2. `Unite` するときに、別々の連結成分であったときには、根ノードのサイズをそれぞれの連結成分のサイズの和で更新する。

注意点として、 **あるノード `x` が所属する連結成分のサイズを参照するときは、 `root(x)` で返される根ノードを参照することで取得するようにすること。**

## Union-Findアルゴリズムの動作イメージの要点

- 根ノードは基本的に不動
- `Unite(Union)` クエリの際のみ、どちらかの根ノードがもう片方を親とするので、そこでのみ片方が根ノードではなくなる。 - ↑のような、連結成分のサイズを管理するような問題では、そのようなイメージを持っておくとミスを減らせる（かも）

