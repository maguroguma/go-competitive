# Bellman-Ford algorithm

## 要点

- 重み付き有向グラフにおける、**単一視点** の最短経路問題を解くアルゴリズム。
- 負のエッジが存在する場合でも正しく計算でき、負の経路の存在を検出・報告することができる。
  - **「i回の更新時点で、i回以下の移動に限定するという条件のもとでの最短路は少なくとも求まる」という点を理解することが非常に重要。**
    - 注意: 更新の順序によってはi回以上の移動が必要な最短路が求まっている場合もあるが、「高々i個の辺からなる経路の最短距離」には反していない。
    - 余談: 「高々」という日本語は頭の中で「at most」と読み替えたい。
- アルゴリズムの正しさは数学的帰納法で示すことができる。

## 計算量

`O(|E| * |V|)`

優先度付きキューを使えば線形対数となるダイクストラ法よりも大きい。

## 競技プログラミング向けのメモ

- [ABC061のD問題](https://abc061.contest.atcoder.jp/tasks/abc061_d)が局所的な閉路の検出もできないと解けないようになっており、理解促進にとても良い。
  - 上の問題の回答コードからもわかるように、コストだけに注目する場合は非常にシンプルなデータ構造およびコードで書ける。
  - ある点が負の閉路に含まれるか（正確には、負の閉路を経由してたどり着けるか）の判定方法:
    1. ある点への最短距離がN-1回後も更新される場合、その点は負の閉路に含まれる。
    2. あるエッジの始点が負の閉路に含まれる場合、そのエッジの終点も負の経路に含まれる。
    3. 最大の負の閉路の大きさ（＝経由するノードの数）はNであるため、N回繰り返せばすべてのノードについてチェックが可能。
