# ABC174 感想

Eでひどくやらかしてしまったが、結局Fが解けていないので今回はレート的にはそれほど落ち込めない。

## A問題

if文書くだけ。

## B問題

for文とfloat64を使う。

## C問題

めちゃくちゃ難しいと思った。
解が存在しない場合の証明ができていない。

解説を観たい。

## D問題

貪欲の証明はできていないが、交換だけ行うのが得だと考えた。

## E問題

決め打ち二分探索だが、判定部分だったり、二分探索の関数を決め打ち用に変え忘れたりとあまりにひどすぎた。
サンプルを冷静に読めば、より早く誤りに気づけたかもしれない。

スニペットを見直す。

## F問題（@2020-08-15）

PDFの説明だけでも理解できる、シンプルな問題では合った。

### PDFの方法

クエリを「右端」で昇順ソートしておき、右端を固定したうえでの「全体で必要な情報を固定」してしまう。
すなわち、固定した右端を含めて左側にある集合のうち、
**各数値（色）について、最も最後に現れたものの座標を記憶しておく。**
そして、fenwick treeにその座標にのみ+1加算しておくことで、あとはクエリに対して区間和を計算してやれば良い。

※この手法で自分でコードを書いてみたが、 `500000` 行の出力の際はバッファリング付き出力をしないと間に合わなかったので注意。

### 解説放送の方法

平面走査法によって解いている。
平面走査法は **x, y軸の片方を固定するイメージ。**

ただし、平面走査法の解法に帰着するまでは、問題の言い換えがあり、この部分は簡単ではない（典型、有名ではあるらしいが）。

解説放送の方針では、「区間内に含まれる、数えてはいけない重複を引き算してやる」というの方針で進めている。
重複分を `x` とすると `(r-l+1) - x` によって個数が求まる。

このために、「同じ数字の間に矢印を張った区間」というものを導入する。
**この区間がクエリ区間に「完全に被覆される場合」、その個数分だけ引いてやる必要がある！**

クエリ区間を `[l, r]` 、数の区間を `[s, t]` とすると、差し引くべき重複となるのは `l <= s && t <= r` という関係の場合。
これらのペアにおいて、関係が気になるのは `(l, s), (r, t)` という具合になるので、
始点の座標をx座標、終点の座標をy座標として2次元座標に区間を「点」としてプロットする。
すると、 **差し引くべき重複の個数は、クエリ点の右下のエリアに被覆される数座標の個数** となる。

そして、これを求めるために、x座標の大きいところから小さいところへ向かって、平面をスライドさせていけば良い。
必要なのは点更新および累積和のみなので、相変わらずfenwick treeのみで解ける。

#### 平面走査法の考え方

- x, y軸の片方を固定するイメージ
- ある座標を時間軸に取り替えることで次元を落とす手法
  - [PAST2回目](https://img.atcoder.jp/past202004-open/editorial.pdf)の公式解説PDFより抜粋。

### 参考

- [けんちょんさんのブログ](https://drken1215.hatenablog.com/entry/2019/01/01/234400)
  - Mo法なるものと、解説PDFの手法が紹介されている。
- [はまづさんのブログ](https://hama-du-competitive.hatenablog.com/entry/2016/10/01/001418)
  - こちらでは上2つに加えて、解説放送の平面走査法についても言及されている。

