# 中央値

Last Change: 2021-01-19 23:03:13.

マンハッタン距離とも関連しなくもないが、独立させて理解したい。

## 基本

数の集合をソートしたときに、奇数個ならばちょうど真ん中のものが中央値。  
偶数の場合は、問題によって定義が微妙に変わるので、注意すること。

- 数直線上のN点と、ある一点のマンハッタン距離の総和を考えるとき、その総和を最小化するのはN点の中央値（複数ある場合はいずれか）。
  - 2次元でも各軸で独立に考えれば良い。
- 数の最大値がわかっている場合、ソート不要で、二分探索によって求めることが可能。
  - 「リニアサーチによって `x` 以上の要素数をカウントして、個数が半分以上だったらOK」という判定問題を解けば良い。

---

## 問題

### [ARC100 C.Linear Approximation](https://atcoder.jp/contests/arc100/tasks/arc100_a)

ほぼ基本をそのまま用いるだけで良い。

### [Tenka1 Programmer Contest 2017 E.CARtesian Coodinate](https://atcoder.jp/contests/tenka1-2017/tasks/tenka1_2017_e)

愚直 `O(N^2)` ではとても間に合わないので工夫が必要。  
ただし、その工夫が天才すぎる。

「直線の無限遠においては、傾きのソート順とは逆向きに `y` 座標の値が並ぶ」という点をまずは抑える。  
この無限遠にある `x` 軸に垂直な軸を、どんどん右にずらすことを考える。  
すると、ある直線同士が交わるタイミングで、 `y` 座標の値が逆転することになる。  
このような逆転はちょうどバブルソートのスワップのように、隣接した箇所で起こる。  
「交点の発生 => 順番の入れ替わり => バブルソートのスワップ」と考えると、そこまでに発生した交点の個数は転倒数によって計算できる。

よって、交点の個数が、交点の総数の半分以上となるようなポイントを、二分探索によって探してやれば良い。

### [ABC107 D.Median of Medians](https://atcoder.jp/contests/abc107/tasks/arc101_b)

巧く問題の言い換えを繰り返すと、累積和の転倒数を数えるような問題を解くことに集中すれば良くなる。  
当然、二分探索を併用する。

BITを使って転倒数を数える場合は、非負かつ `N = 10^6` 程度しか数えられないことはちゃんと意識しておきたい。  
（大抵は0-indexな添字を使うことが多い？）

**※ `O(N^2)` の数え上げツールとして、こういった問題における転倒数の使い方は覚えておきたい。**

### [ABC127 F.Absolute Minima](https://atcoder.jp/contests/abc127/tasks/abc127_f)

中央値を意識せずとも、最小値をとるのは中央値だというのは考察できた。  
とはいえ、その部分はもっと短時間で思いつきたい、絶対値が出てきたら距離だとか中央値をイメージしたい。

具体的な最小値の求め方が難しい。  
おそらくは中央値を扱うのに昇順・降順で整列されるデータ構造を2つ用意して、片方は左半分、片方は右半分、
しかもそれぞれに1つずつおなじ要素を詰める、というやり方は天才的にみえるが、典型なのかもしれない。

※ そもそも最小値をインクリメンタルに更新する方法に考えが至らなかったので、まずはそこからだが。。

