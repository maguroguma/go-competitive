# 分割統治法

Last Change: 2020-12-16 00:52:24.

## 参考

- [tsutajさんの解説スライド（PDF）](https://compro.tsutaj.com//archive/190207_divcon.pdf)
- [はまやんさんの問題集](https://www.hamayanhamayan.com/entry/2017/05/21/234616)

---

## 考え方

手探りながらまとめていきたい。

- 半分半分に分割すると高さが `log` になるから、それぞれのマージ処理を線形オーダーでやることを目指す、というのがやるべきことか？

---

## 例題

### 転倒数

一見して難しそうに見えるが、コードを良く読んでみると
**「マージソートするついでに、左右の配列の間で生じる転倒数を素直に数える」**
ということをやっているだけだった。

マージソートは、左右の配列がソート済みだと、マージの際に線形オーダー（厳密には違いそう）
で処理が可能、という理解をしている。  
「転倒数を数える」という処理を追加したとしても、計算量は変わらない、ということ。

### 2つの和

以下のような問題を分割統治法で `O(nlogn)` で解く。

> 数列 `A` について `A[i] + A[j] <= k` を満たすペア `(i, j)` の総数を求めよ。

この問題が解けると `solve(k) - solve(k-1)` とすることで 「`k` に等しいもののペアの数」も求めることができる。

この問題の解き方も転倒数と同じようなもので、転倒数を数える部分を和の計算とチェックに変えるような形になる。  
数え方は「左の配列は大きい方から、右の配列は小さい方からスライドさせて、右の配列を指すインデックスを答えに加算する」
という形で求める。  
別の言い方をすると「左の各要素を大きい方から順に見て、それぞれについて条件を満たす物の数を全てについて足す」というようなことを行っている。

### 木の重心


### 最近点対



