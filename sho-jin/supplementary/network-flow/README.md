# ネットワークフロー

Last Change: 2020-12-17 01:14:46.

基本はけんちょん本で学んでいく。

## 用語の整理

グラフ用語であまり頭に入っていないものが多い。

- カット: `(S, T)`
  - 頂点集合 `V` の分割のこと、ただし、互いに共通頂点を持たず、それぞれ空集合は許されない。
- カット辺
  - カット `(S, T)` について `S` に含まれる頂点と `T` に含まれる頂点とを結ぶ辺のこと。
- カットセット
  - カット辺全体の集合のこと。
- カットの容量 `c(S, T)`
  - カットセットに含まれる辺の本数。
- 辺連結度
  - 頂点 `s, t` のパスで、互いに辺を共有しないものの、取れる本数の最大値
- 辺素
  - 互いに辺を共有しないこと。
- 増加パス
  - すでにある `s-t` パスに使われている辺については逆流を許しながら、新たに追加できる `s-t` パスのこと。
- 残余グラフ
  - ある `s-t` パスをとったときに、パス上の各辺に対して逆向きの辺を張り直したグラフを新たに考えたもの。
- 辺の容量、辺の流量
  - 各辺で許される流量の最大値
- 総流量
  - 頂点 `s` から出ていく辺 `e` に対する流量の総和
- フロー
  - 各辺の流量全体を総括する言葉（？）
- 最大フロー
  - 総流量が最大のフロー

### 最小カット問題

「有向グラフ `G = (V, E)` と2頂点 `s, t` が与えられたとき、 `s-t` カットのうち、容量が最小のものを求めよ」という問題。  
「グラフ `G` 上で最小本数の辺を取り除くことで、 `s-t` 間を分断する問題」ともいえる。

#### 辺連結度に関する問題の強双対性

`辺素な s-t パスの最大本数（辺連結度） == s-t カットの最小容量`

#### 2頂点 `s-t` 間の辺連結度を求めるアルゴリズム（フォードファルカーソン法）

```
f := 0 // パスの本数
G' = G
while G'において s-t パス P が存在する:
  f++
  G' = P に関する残余グラフ
return f
```

このアルゴリズムの計算量は `O(|V| * |E|)` となる。

- `s` から出る辺の数は最大で `|V|-1`
- 各反復で `s-t` パスを見つける処理は `O(|E|)` で可能

### 最大流問題

最大フローを求める問題。

通常は、最大流問題においては、各辺 `e` の容量 `c(e)` は正の整数値とする。

※ 「辺連結度に関する問題」は、最大流問題に置いて各辺の容量が `1` の問題と考えることができる。

#### 最小カット問題との双対性

> 辺連結度を求める問題に対しては、その双対問題である最小カット問題を考えることで、
> 「最適性の証拠」を突きつけることが出来ました。
> **同様に、一般の最大流問題に対しても、その双対問題として最小カット問題（辺に重みがあるバージョン）を考えることが出来ます。**

#### 最小カット問題（各辺の容量を `2` 以上に拡張）

> 容量付き有向グラフ `G = (V, E)` と2頂点 `s, t` が与えられたときの `s-t` カットのうち、
> 容量が最小のものを求める問題。

「辺連結度の問題」が「最小カット問題」と強双対であったのと同様に、以下の強双対性（最大流最小カット定理）が成立する。

`最大フローの総流量 = s-t カットの最小容量`

#### 最大流を求めるフォード・ファルカーソン法

```
F := 0 // フロー流量
G' := G // G'は残余グラフ
while G'において s-t パス P が存在する:
  f := パス P 上の各辺の容量の最小値
  F += f
  パス P 上に大きさ f のフローを流す
  残余グラフG'を更新する
return F
```

このアルゴリズムの計算量は、最大流値を `F` としたとき `O(F * |E|)` となる。

- 各反復によって総流量は最低でも `1` 以上増加していくことから、反復回数は `F` 回で抑えられる。
- 各反復に `O(|E|)` の計算量を要する。

※ **`|V|, |E|` といった量は「個数」を表すが、 `F` は「数値」を表す量である。**
**このように、数値に関して多項式であるが実際には多項式時間ではない計算量を「擬多項式時間」と呼ぶ。**

### 最小費用流問題

けんちょん本で扱っておらず。  
学習には同じくけんちょん氏作の[Qiitaのこのページ](https://qiita.com/drken/items/e805e3f514acceb87602#3-2-%E6%9C%80%E5%B0%8F%E8%B2%BB%E7%94%A8%E6%B5%81%E5%95%8F%E9%A1%8C)
などがいいかもしれない。

