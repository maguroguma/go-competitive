# AGC038 過去問感想

Last Change: 2020-02-24 12:53:37.

- A問題は300点の構築。
  - 自分は本番に参加していたら絶対に解けていないもの。
  - 答えを見てしまうとそうとしか思えないけど、天才パズルに見えてしまう、難しい。
  - 左上に1を敷き詰めるのは良いが、全体を俯瞰して見ることが出来ず、構築できない場合を想像してしまった。

## B問題（@2020-02-22）

嘘解法に陥ってしまった気がしたので、解説を観た。

- 基本は `n-k+1` 個なんだけど、ダブリがあるのでそれを除くことを考える。
  - ベースラインとして全部異なる、というところから考える。
- `k` 個の区間にダブりがない場合は「どちらもソート済み」の場合のみダブル。

。。なんか話を聞いているうちに、自分のセグ木使った解法も正解に辿り着けそうな気がしてきたので、もう少し考えてみる。

自分の考察はそこまで間違っていなかった。
ただし「なんとなく行けそう」ぐらいにしか思えておらず、確信を持って考察を進めるには、
解説放送の考察が必要だった。

解説は今回のものはPDFのものが有益だったように思える。
すなわち、以下が数え上げに当たってポイントとなる。

- 区間 `[i, i+k)` と `[j, j+k)` のソート後がそれぞれ等しい場合は、これらの区間をequivalentであると見る。
- **区間をノードとみなして、equivalentなもの同士に辺を貼る（Union Find木を使う）、最後にそれらの連結成分の数を数える。**
  - 重ならない区間でequivalentな条件は「それぞれの区間がすでにソート済みである場合」のみ。
  - 重なる区間については、1つずつずらして左端がMinで右端がMaxであればよい。
    - この部分をもっと明確にしようと思うと、重なる部分を一般化（1つずつずらすとかではなく、重なる和をちゃんと文字式で捉える必要がある）する必要がある。

結局、数え上げの部分が正しくできなかった。
解説放送では、りんごさんいわく重複を引き算するような方法をざっくりと説明していたが、正直難しくてよく理解できなかった。
**個人的には、やはり数え上げは排反な事象を足し上げる方針のほうが理解しやすい気がする。**

**典型: UFを使って「同じグループの数」を賢く数える。**

なお、区間の最小・最大を求める部分はそれぞれ別々のセグメントツリーを使ったが、
「スライド最小値」というものを使うと `O(n)` で済むらしい。

参考: [スライド最小値](http://statmodeling.hatenablog.com/entry/ant-book-slide-min)

### UFによる数え上げ

当然ではあるが、 `10^9+7` で割ったあまりを求めよ、とかには使えない。数える対象が多すぎるので。

せいぜい `n=10^7` 個ぐらいが全体の数となるようなものにしか適用できないことに注意。
問題設定のパターン的に、大抵は今回のような `n=10^5` に対して用いるものが大半だと思われる。

