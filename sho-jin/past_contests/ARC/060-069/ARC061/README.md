# ARC061 過去問感想

- E問題はABC132の復習として解いてみた。
  - 自分で考えて書いたコードは間違いだった（一部通るが一部WAになる）。
    - 自分が書いた方法だと、おそらく各駅に乗り換える場合でも全部今までのコストに+1された場合のいずれか1駅しか考慮されない。
    - 「乗り換え」をすべての駅で同一とみなしてはいけない、ということ。
      - 同じ目的の駅に向かう場合でも、乗り換える路線によっては、その後が有利に進められる可能性がある。
        - 今回は多重辺があるようなグラフもカバーする必要があるはず。
  - **典型: 拡張グラフにおけるダイクストラ法の適用**
    - グラフの作り方が簡単ではないパターン。

---

## E問題

[アルメリアさんの解説記事](https://betrue12.hateblo.jp/entry/2019/05/25/134323)がかなりわかりやすい。
C++の提出コードを読んだあとだと、いろいろと詳細部分がわかってよりよい。

振り返ってみても実装がかなり大変。
ポイントはいろいろある。

- `(駅ID, （直前に利用した路線の）会社ID)` というペアでノードを定義する（`Node` 構造体）。
- `map[Node]int` という辞書で、ノード構造体からハッシュIDを逆引きする。
  - これは必ずしも必要というわけではなさそう。
  - 都度ハッシュIDを計算するのとどちらが高速なのかは気になるところ。
  - アルメリアさんのコードでは「座標圧縮の容量でハッシュ化」とあるが、詳細はよくわからず。。
- ありうる頂点を最初にまとめて列挙して、以降を見通しよくしている（`nodeList`）。
  - おそらく、重複したノードも入っているケースが有るはず。
    - このせいで、あとのエッジを張る部分で、改札内と改札外を行き来するエッジが重複してはられることがあると思われるが、 **ダイクストラ法は負数のコストを含まない限りは問題なく動作するはず** なので、問題にはなっていないと思われる。
  - 辺は増えるが、最大でもたかだか `2M` 本程度になるはず。
- **改札外から改札内をコスト1、改札内から改札外をコスト0として考える。**
- `var edges map[int][]Edge` という形でエッジを管理する。
  - **辞書の値としてスライスを取ることは、プログラム上問題ない**
    - たしかこのスライスをソートしてしまうと壊れてしまうことがあった気がするが、調査しきれていない。
  - キーをノードのハッシュIDとすることで、キーをノードにするよりも見通しが良いと思われる。
    - 繰り返しになるが、ハッシュ計算とノード構造体のインスタンス化と、どちらが計算量的に厳しいのかは気になるところ。
- ハッシュIDで考えた頂点間に希望通りのエッジが全て張れたあとは、ただ単にダイクストラ法を実行するだけで良い。
  - 準備がとにかく大変。

